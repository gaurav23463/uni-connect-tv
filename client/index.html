<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Uni-Connect TV - Student Video Chat</title>
  <style>
    body {
      box-sizing: border-box;
    }

    :root {
      --bg-dark: #0f0f10;
      --accent-cyan: #00f0ff;
      --accent-pink: #ff00c8;
      --text-white: #ffffff;
      --glass-bg: rgba(255, 255, 255, 0.05);
      --glass-border: rgba(255, 255, 255, 0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-dark);
      color: var(--text-white);
      overflow-x: hidden;
    }

    /* Animated Background */
    .animated-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      overflow: hidden;
    }

    .bubble {
      position: absolute;
      bottom: -100px;
      background: radial-gradient(circle, var(--accent-cyan) 0%, transparent 70%);
      border-radius: 50%;
      opacity: 0.3;
      animation: float-up 15s infinite ease-in-out;
    }

    .bubble:nth-child(1) {
      left: 10%;
      width: 80px;
      height: 80px;
      animation-delay: 0s;
    }

    .bubble:nth-child(2) {
      left: 30%;
      width: 120px;
      height: 120px;
      animation-delay: 3s;
    }

    .bubble:nth-child(3) {
      left: 50%;
      width: 100px;
      height: 100px;
      animation-delay: 6s;
    }

    .bubble:nth-child(4) {
      left: 70%;
      width: 90px;
      height: 90px;
      animation-delay: 9s;
      background: radial-gradient(circle, var(--accent-pink) 0%, transparent 70%);
    }

    .bubble:nth-child(5) {
      left: 85%;
      width: 110px;
      height: 110px;
      animation-delay: 12s;
      background: radial-gradient(circle, var(--accent-pink) 0%, transparent 70%);
    }

    @keyframes float-up {
      0% {
        transform: translateY(0) scale(1);
        opacity: 0.3;
      }
      50% {
        opacity: 0.5;
      }
      100% {
        transform: translateY(-100%) scale(1.2);
        opacity: 0;
      }
    }

    /* Landing Page */
    #landing {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100%;
      padding: 20px;
      opacity: 1;
      transform: scale(1);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    #landing.hidden {
      opacity: 0;
      transform: scale(0.95);
      pointer-events: none;
    }

    .logo-3d {
      font-size: 64px;
      font-weight: 900;
      background: linear-gradient(135deg, var(--accent-cyan), var(--accent-pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 40px rgba(0, 240, 255, 0.5);
      margin-bottom: 20px;
      animation: glow-pulse 3s ease-in-out infinite;
      text-align: center;
    }

    @keyframes glow-pulse {
      0%, 100% {
        filter: drop-shadow(0 0 20px rgba(0, 240, 255, 0.6));
      }
      50% {
        filter: drop-shadow(0 0 40px rgba(255, 0, 200, 0.8));
      }
    }

    .tagline {
      font-size: 18px;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 40px;
      text-align: center;
    }

    .glass-btn {
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      padding: 16px 40px;
      border-radius: 12px;
      color: var(--text-white);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 32px rgba(0, 240, 255, 0.2);
      margin: 10px;
    }

    .glass-btn:hover {
      transform: translateY(-4px) scale(1.05);
      box-shadow: 0 12px 48px rgba(0, 240, 255, 0.4);
      border-color: var(--accent-cyan);
    }

    .glass-btn.primary {
      background: linear-gradient(135deg, var(--accent-cyan), var(--accent-pink));
      border: none;
    }

    /* Modal */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal.active {
      display: flex;
      opacity: 1;
    }

    .modal-content {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      padding: 40px;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 240, 255, 0.3);
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .modal.active .modal-content {
      transform: scale(1);
    }

    .modal-header {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 30px;
      text-align: center;
      background: linear-gradient(135deg, var(--accent-cyan), var(--accent-pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      color: rgba(255, 255, 255, 0.8);
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--glass-border);
      border-radius: 8px;
      color: var(--text-white);
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--accent-cyan);
      box-shadow: 0 0 20px rgba(0, 240, 255, 0.3);
    }

    .form-group select option {
      background: var(--bg-dark);
      color: var(--text-white);
    }

    .modal-actions {
      display: flex;
      gap: 10px;
      margin-top: 30px;
    }

    .modal-actions button {
      flex: 1;
    }

    /* Chat Interface */
    #chatInterface {
      position: relative;
      z-index: 1;
      display: none;
      flex-direction: column;
      height: 100%;
      opacity: 0;
      transform: scale(0.95);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    #chatInterface.active {
      display: flex;
      opacity: 1;
      transform: scale(1);
    }

    /* Top Nav */
    .top-nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--glass-border);
    }

    .nav-logo {
      font-size: 24px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent-cyan), var(--accent-pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .profile-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent-cyan), var(--accent-pink));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .profile-avatar:hover {
      transform: scale(1.1);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      padding: 20px;
      gap: 20px;
      overflow: hidden;
    }

    .video-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .video-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      flex: 1;
    }

    .video-box {
      position: relative;
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      border: 2px solid var(--glass-border);
      border-radius: 20px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .video-box.active {
      border-color: var(--accent-cyan);
      box-shadow: 0 0 40px rgba(0, 240, 255, 0.4);
    }

    .video-box video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .video-placeholder {
      font-size: 48px;
      opacity: 0.3;
    }

    .status-indicator {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #4ade80;
      box-shadow: 0 0 20px #4ade80;
      animation: pulse-status 2s ease-in-out infinite;
    }

    .status-indicator.offline {
      background: #ef4444;
      box-shadow: 0 0 20px #ef4444;
    }

    @keyframes pulse-status {
      0%, 100% {
        transform: scale(1);
        opacity: 1;
      }
      50% {
        transform: scale(1.2);
        opacity: 0.8;
      }
    }

    .video-label {
      position: absolute;
      bottom: 16px;
      left: 16px;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
    }

    /* Controls */
    .controls {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .control-btn {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .control-btn:hover {
      transform: translateY(-4px) scale(1.1);
      box-shadow: 0 8px 32px rgba(0, 240, 255, 0.4);
      border-color: var(--accent-cyan);
    }

    .control-btn.danger:hover {
      border-color: #ef4444;
      box-shadow: 0 8px 32px rgba(239, 68, 68, 0.4);
    }

    /* Chat Sidebar */
    .chat-sidebar {
      width: 350px;
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transform: translateX(0);
      transition: transform 0.3s ease;
    }

    .chat-header {
      padding: 20px;
      border-bottom: 1px solid var(--glass-border);
      font-size: 18px;
      font-weight: 700;
    }

    .chat-messages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .chat-messages::-webkit-scrollbar {
      width: 6px;
    }

    .chat-messages::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }

    .chat-messages::-webkit-scrollbar-thumb {
      background: var(--accent-cyan);
      border-radius: 3px;
    }

    .message {
      padding: 12px 16px;
      border-radius: 12px;
      max-width: 80%;
      animation: slide-in 0.3s ease;
    }

    @keyframes slide-in {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message.sent {
      align-self: flex-end;
      background: linear-gradient(135deg, var(--accent-cyan), var(--accent-pink));
    }

    .message.received {
      align-self: flex-start;
      background: rgba(255, 255, 255, 0.1);
    }

    .chat-input-area {
      padding: 20px;
      border-top: 1px solid var(--glass-border);
      display: flex;
      gap: 12px;
    }

    .chat-input {
      flex: 1;
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      color: var(--text-white);
      font-size: 14px;
    }

    .chat-input:focus {
      outline: none;
      border-color: var(--accent-cyan);
    }

    .send-btn {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--accent-cyan), var(--accent-pink));
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .send-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 8px 32px rgba(0, 240, 255, 0.5);
    }

    /* Floating Toolbar */
    .floating-toolbar {
      position: fixed;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 100;
    }

    .toolbar-btn {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--glass-border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .toolbar-btn:hover {
      transform: scale(1.1);
      background: rgba(0, 240, 255, 0.2);
      border-color: var(--accent-cyan);
    }

    .toolbar-btn .tooltip {
      position: absolute;
      right: 60px;
      background: rgba(0, 0, 0, 0.9);
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 12px;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .toolbar-btn:hover .tooltip {
      opacity: 1;
    }

    /* Toast Notifications */
    .toast-container {
      position: fixed;
      top: 80px;
      right: 20px;
      z-index: 2000;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .toast {
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      padding: 16px 20px;
      min-width: 300px;
      display: flex;
      align-items: center;
      gap: 12px;
      animation: toast-in 0.3s ease;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    @keyframes toast-in {
      from {
        opacity: 0;
        transform: translateX(100px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .toast.success {
      border-left: 4px solid #4ade80;
    }

    .toast.warning {
      border-left: 4px solid #fbbf24;
    }

    .toast.danger {
      border-left: 4px solid #ef4444;
    }

    .toast-icon {
      font-size: 24px;
    }

    .toast-message {
      flex: 1;
      font-size: 14px;
    }

    /* Footer */
    .footer {
      padding: 20px;
      text-align: center;
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      border-top: 1px solid var(--glass-border);
      font-size: 14px;
    }

    .footer-text {
      margin-bottom: 12px;
      color: rgba(255, 255, 255, 0.7);
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 16px;
    }

    .social-link {
      color: var(--text-white);
      font-size: 20px;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      color: var(--accent-cyan);
      transform: translateY(-4px);
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .chat-sidebar {
        position: fixed;
        right: 0;
        top: 0;
        height: 100%;
        z-index: 500;
        transform: translateX(100%);
      }

      .chat-sidebar.active {
        transform: translateX(0);
      }

      .floating-toolbar {
        right: 10px;
      }
    }

    @media (max-width: 768px) {
      .logo-3d {
        font-size: 48px;
      }

      .video-grid {
        grid-template-columns: 1fr;
      }

      .main-content {
        flex-direction: column;
        padding: 12px;
      }

      .chat-sidebar {
        width: 100%;
      }

      .controls {
        gap: 8px;
      }

      .control-btn {
        width: 48px;
        height: 48px;
        font-size: 20px;
      }

      .floating-toolbar {
        flex-direction: row;
        top: auto;
        bottom: 100px;
        right: 50%;
        transform: translateX(50%);
      }

      .toolbar-btn .tooltip {
        right: auto;
        top: -40px;
        left: 50%;
        transform: translateX(-50%);
      }

      .toast {
        min-width: 250px;
      }
    }

    @media (max-width: 480px) {
      .logo-3d {
        font-size: 36px;
      }

      .tagline {
        font-size: 14px;
      }

      .glass-btn {
        padding: 12px 24px;
        font-size: 14px;
      }

      .modal-content {
        padding: 24px;
      }

      .top-nav {
        padding: 12px 16px;
      }

      .nav-logo {
        font-size: 18px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Animated Background -->
  <div class="animated-bg">
   <div class="bubble"></div>
   <div class="bubble"></div>
   <div class="bubble"></div>
   <div class="bubble"></div>
   <div class="bubble"></div>
  </div><!-- Landing Page -->
  <div id="landing">
   <h1 class="logo-3d">Uni-Connect TV</h1>
   <p class="tagline">Connect with students worldwide</p><button class="glass-btn primary" id="loginBtn">Login with Email</button> <button class="glass-btn" id="demoChatBtn">Join Demo Chat</button>
  </div><!-- Login Modal -->
  <div class="modal" id="loginModal">
   <div class="modal-content">
    <h2 class="modal-header">Welcome Back</h2>
    <form id="loginForm">
     <div class="form-group"><label for="email">Email Address</label> <input type="email" id="email" placeholder="student@university.edu" required>
     </div>
     <div class="form-group"><label for="password">Password</label> <input type="password" id="password" placeholder="Enter your password" required>
     </div>
     <div class="form-group"><label for="department">Department</label> <select id="department" required> <option value="">Select Department</option> <option value="computer-science">Computer Science</option> <option value="engineering">Engineering</option> <option value="business">Business</option> <option value="arts">Arts</option> <option value="science">Science</option> <option value="medicine">Medicine</option> </select>
     </div>
     <div class="modal-actions"><button type="button" class="glass-btn" id="cancelBtn">Cancel</button> <button type="submit" class="glass-btn primary">Login</button>
     </div>
    </form>
   </div>
  </div><!-- Chat Interface -->
  <div id="chatInterface"><!-- Top Navigation -->
   <nav class="top-nav">
    <div class="nav-logo">
     Uni-Connect TV
    </div>
    <div class="nav-right">
     <div class="profile-avatar" id="profileAvatar">
      U
     </div><button class="glass-btn" id="logoutBtn" style="padding: 8px 16px; margin: 0;">Logout</button>
    </div>
   </nav><!-- Main Content -->
   <div class="main-content">
    <div class="video-section">
     <div class="video-grid"><!-- Local Video -->
      <div class="video-box active" id="videoLocalBox">
       <div class="video-placeholder">
        üé•
       </div>
       <video id="videoLocal" autoplay muted playsinline style="display: none;"></video>
       <div class="status-indicator"></div>
       <div class="video-label">
        You
       </div>
      </div><!-- Remote Video -->
      <div class="video-box" id="videoRemoteBox">
       <div class="video-placeholder">
        üë§
       </div>
       <video id="videoRemote" autoplay playsinline style="display: none;"></video>
       <div class="status-indicator offline"></div>
       <div class="video-label">
        Partner
       </div>
      </div>
     </div><!-- Controls -->
     <div class="controls"><button class="control-btn" id="btnMute" title="Mute/Unmute">üé§</button> <button class="control-btn" id="btnCamera" title="Camera On/Off">üé•</button> <button class="control-btn" id="btnNext" title="Next Partner">üîÑ</button> <button class="control-btn danger" id="btnReport" title="Report">‚ö†Ô∏è</button> <button class="control-btn danger" id="btnEnd" title="End Chat">üö™</button>
     </div>
    </div><!-- Chat Sidebar -->
    <div class="chat-sidebar" id="chatSidebar">
     <div class="chat-header">
      Chat Messages
     </div>
     <div class="chat-messages" id="chatMessages">
      <div class="message received">
       Welcome to Uni-Connect TV! üëã
      </div>
     </div>
     <div class="chat-input-area"><input type="text" class="chat-input" id="chatInput" placeholder="Type a message..."> <button class="send-btn" id="sendBtn">üì§</button>
     </div>
    </div>
   </div><!-- Footer -->
   <div class="footer">
    <div class="footer-text">
     Made with ‚ù§Ô∏è by Gaurav Tripathi
    </div>
    <div class="social-links"><a href="https://instagram.com" target="_blank" rel="noopener noreferrer" class="social-link">üì∑</a> <a href="https://linkedin.com" target="_blank" rel="noopener noreferrer" class="social-link">üíº</a> <a href="https://github.com" target="_blank" rel="noopener noreferrer" class="social-link">üíª</a>
    </div>
   </div>
  </div><!-- Floating Toolbar -->
  <div class="floating-toolbar" id="floatingToolbar" style="display: none;"><button class="toolbar-btn" id="filterBtn"> üé® <span class="tooltip">Filters</span> </button> <button class="toolbar-btn" id="themeBtn"> üî¶ <span class="tooltip">Theme</span> </button> <button class="toolbar-btn" id="blurBtn"> üí´ <span class="tooltip">Blur</span> </button>
  </div><!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>
  <script src="/_sdk/element_sdk.js"></script>
  <script>
    // Configuration
    const defaultConfig = {
      app_title: 'Uni-Connect TV',
      tagline: 'Connect with students worldwide',
      footer_text: 'Made by Gaurav Tripathi.'
    };

    let config = { ...defaultConfig };

    // Initialize Element SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (newConfig) => {
          config = { ...defaultConfig, ...newConfig };
          
          // Update app title
          const logoElements = document.querySelectorAll('.logo-3d, .nav-logo');
          logoElements.forEach(el => {
            el.textContent = config.app_title || defaultConfig.app_title;
          });
          
          // Update tagline
          const taglineEl = document.querySelector('.tagline');
          if (taglineEl) {
            taglineEl.textContent = config.tagline || defaultConfig.tagline;
          }
          
          // Update footer
          const footerTextEl = document.querySelector('.footer-text');
          if (footerTextEl) {
            footerTextEl.textContent = config.footer_text || defaultConfig.footer_text;
          }
        },
        mapToCapabilities: (config) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['app_title', config.app_title || defaultConfig.app_title],
          ['tagline', config.tagline || defaultConfig.tagline],
          ['footer_text', config.footer_text || defaultConfig.footer_text]
        ])
      });
    }

    // State
    let currentUser = null;
    let isMuted = false;
    let isCameraOn = true;
    let localStream = null;
    let remoteStream = null;

    // Elements
    const landing = document.getElementById('landing');
    const chatInterface = document.getElementById('chatInterface');
    const loginModal = document.getElementById('loginModal');
    const loginBtn = document.getElementById('loginBtn');
    const demoChatBtn = document.getElementById('demoChatBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const loginForm = document.getElementById('loginForm');
    const logoutBtn = document.getElementById('logoutBtn');
    const chatMessages = document.getElementById('chatMessages');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');
    const btnMute = document.getElementById('btnMute');
    const btnCamera = document.getElementById('btnCamera');
    const btnNext = document.getElementById('btnNext');
    const btnReport = document.getElementById('btnReport');
    const btnEnd = document.getElementById('btnEnd');
    const floatingToolbar = document.getElementById('floatingToolbar');
    const toastContainer = document.getElementById('toastContainer');
    const profileAvatar = document.getElementById('profileAvatar');

    // Show Toast Notification
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      
      const icon = type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ùå';
      
      toast.innerHTML = `
        <div class="toast-icon">${icon}</div>
        <div class="toast-message">${message}</div>
      `;
      
      toastContainer.appendChild(toast);
      
      setTimeout(() => {
        toast.style.animation = 'toast-in 0.3s ease reverse';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    // Show Login Modal
    loginBtn.addEventListener('click', () => {
      loginModal.classList.add('active');
    });

    // Hide Login Modal
    cancelBtn.addEventListener('click', () => {
      loginModal.classList.remove('active');
    });

    // Handle Login
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const department = document.getElementById('department').value;
      
      // Simulate API call
      // In production: await fetch('https://uni-connect-tv-5.onrender.com/api/auth', { method: 'POST', ... })
      
      currentUser = {
        email,
        department,
        name: email.split('@')[0]
      };
      
      profileAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
      
      loginModal.classList.remove('active');
      startChat();
    });

    // Demo Chat
    demoChatBtn.addEventListener('click', () => {
      currentUser = {
        email: 'demo@student.edu',
        department: 'demo',
        name: 'Demo User'
      };
      
      profileAvatar.textContent = 'D';
      startChat();
    });

    // Start Chat
    function startChat() {
      landing.classList.add('hidden');
      setTimeout(() => {
        landing.style.display = 'none';
        chatInterface.classList.add('active');
        floatingToolbar.style.display = 'flex';
        initializeMedia();
        showToast('Connected successfully!', 'success');
      }, 600);
    }

    // Initialize Media
    async function initializeMedia() {
      try {
        localStream = await navigator.mediaDevices.getUserMedia({ 
          video: true, 
          audio: true 
        });
        
        const videoLocal = document.getElementById('videoLocal');
        videoLocal.srcObject = localStream;
        videoLocal.style.display = 'block';
        document.querySelector('#videoLocalBox .video-placeholder').style.display = 'none';
        
        // Simulate socket connection
        // In production: const socket = io('https://uni-connect-tv-5.onrender.com');
        
      } catch (error) {
        showToast('Camera/microphone access denied', 'danger');
      }
    }

    // Mute Toggle
    btnMute.addEventListener('click', () => {
      isMuted = !isMuted;
      if (localStream) {
        localStream.getAudioTracks().forEach(track => {
          track.enabled = !isMuted;
        });
      }
      btnMute.textContent = isMuted ? 'üîá' : 'üé§';
      showToast(isMuted ? 'Microphone muted' : 'Microphone unmuted', 'success');
    });

    // Camera Toggle
    btnCamera.addEventListener('click', () => {
      isCameraOn = !isCameraOn;
      if (localStream) {
        localStream.getVideoTracks().forEach(track => {
          track.enabled = isCameraOn;
        });
      }
      btnCamera.textContent = isCameraOn ? 'üé•' : 'üì∑';
      showToast(isCameraOn ? 'Camera turned on' : 'Camera turned off', 'success');
    });

    // Next Partner
    btnNext.addEventListener('click', () => {
      showToast('Finding next partner...', 'warning');
      // In production: socket.emit('next-partner');
    });

    // Report
    btnReport.addEventListener('click', () => {
      const confirmed = confirm('Are you sure you want to report this user?');
      if (confirmed) {
        showToast('User reported. Thank you.', 'success');
        // In production: socket.emit('report', { userId: remoteUserId });
      }
    });

    // End Chat
    btnEnd.addEventListener('click', () => {
      if (localStream) {
        localStream.getTracks().forEach(track => track.stop());
      }
      
      chatInterface.classList.remove('active');
      floatingToolbar.style.display = 'none';
      
      setTimeout(() => {
        chatInterface.style.display = 'none';
        landing.style.display = 'flex';
        landing.classList.remove('hidden');
      }, 600);
      
      showToast('Chat ended', 'success');
    });

    // Logout
    logoutBtn.addEventListener('click', () => {
      if (localStream) {
        localStream.getTracks().forEach(track => track.stop());
      }
      
      currentUser = null;
      chatInterface.classList.remove('active');
      floatingToolbar.style.display = 'none';
      
      setTimeout(() => {
        chatInterface.style.display = 'none';
        landing.style.display = 'flex';
        landing.classList.remove('hidden');
      }, 600);
      
      showToast('Logged out successfully', 'success');
    });

    // Send Message
    function sendMessage() {
      const message = chatInput.value.trim();
      if (!message) return;
      
      const messageEl = document.createElement('div');
      messageEl.className = 'message sent';
      messageEl.textContent = message;
      chatMessages.appendChild(messageEl);
      
      chatInput.value = '';
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      // In production: socket.emit('chat-message', message);
    }

    sendBtn.addEventListener('click', sendMessage);
    chatInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendMessage();
    });

    // Filter Toggle
    let currentFilter = 0;
    const filters = ['none', 'grayscale(1)', 'sepia(1)', 'hue-rotate(180deg)'];
    const filterNames = ['Normal', 'Cool', 'Warm', 'Anime'];
    
    document.getElementById('filterBtn').addEventListener('click', () => {
      currentFilter = (currentFilter + 1) % filters.length;
      const videoLocal = document.getElementById('videoLocal');
      videoLocal.style.filter = filters[currentFilter];
      showToast(`Filter: ${filterNames[currentFilter]}`, 'success');
    });

    // Theme Toggle
    let isDarkTheme = true;
    document.getElementById('themeBtn').addEventListener('click', () => {
      isDarkTheme = !isDarkTheme;
      document.documentElement.style.setProperty('--bg-dark', isDarkTheme ? '#0f0f10' : '#1a1a2e');
      showToast(isDarkTheme ? 'Dark theme' : 'Light theme', 'success');
    });

    // Blur Toggle
    let blurAmount = 0;
    document.getElementById('blurBtn').addEventListener('click', () => {
      blurAmount = blurAmount === 0 ? 10 : 0;
      const videoLocal = document.getElementById('videoLocal');
      videoLocal.style.backdropFilter = `blur(${blurAmount}px)`;
      showToast(blurAmount > 0 ? 'Background blur on' : 'Background blur off', 'success');
    });

    // Mobile Chat Toggle
    if (window.innerWidth <= 1024) {
      const toggleChatBtn = document.createElement('button');
      toggleChatBtn.className = 'control-btn';
      toggleChatBtn.textContent = 'üí¨';
      toggleChatBtn.title = 'Toggle Chat';
      document.querySelector('.controls').appendChild(toggleChatBtn);
      
      toggleChatBtn.addEventListener('click', () => {
        document.getElementById('chatSidebar').classList.toggle('active');
      });
    }

    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script>
  // ‚úÖ Backend URL (update if your backend changes)
  const API_BASE =
    window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1"
      ? "http://localhost:5000"
      : "https://uni-connect-tv-5.onrender.com";

  const socket = io(API_BASE);
  let peerConnection, localStream, partnerId;
  const servers = {
    iceServers: [
      { urls: ["stun:stun.l.google.com:19302"] },
      { urls: ["stun:stun1.l.google.com:19302"] },
    ],
  };

  // üåê AUTH HANDLER
  async function handleAuth(event) {
    event.preventDefault();
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const department = document.getElementById("department").value;

    try {
      const res = await fetch(`${API_BASE}/api/auth`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password, department }),
      });

      if (!res.ok) throw new Error(await res.text());
      const data = await res.json();

      localStorage.setItem("token", data.token);
      localStorage.setItem("email", data.email);
      showNotification(`Welcome ${data.email} from ${data.department}`, "success");
      startChat();
    } catch (err) {
      console.error("Auth error:", err);
      showNotification("Login failed: " + err.message, "danger");
    }
  }

  // üé• START CHAT (video + socket)
  async function startChat() {
    document.getElementById("landing").style.display = "none";
    document.getElementById("chatInterface").style.display = "flex";
    await initCamera();
    socket.emit("find-partner");
  }

  // üì∏ INIT CAMERA
  async function initCamera() {
    try {
      localStream = await navigator.mediaDevices.getUserMedia({
        video: { width: { ideal: 1280 }, height: { ideal: 720 } },
        audio: true,
      });

      const localVideo = document.getElementById("videoLocal");
      localVideo.srcObject = localStream;
      localVideo.muted = true;
      await localVideo.play();
    } catch (err) {
      showNotification("‚ö†Ô∏è Allow camera & mic access!", "warning");
      console.error("Camera error:", err);
    }
  }

  // üí¨ CHAT SYSTEM
  function handleChatInput(event) {
    if (event.key === "Enter" && !event.shiftKey) {
      event.preventDefault();
      const input = document.getElementById("chatInput");
      const message = input.value.trim();
      if (!message) return;
      addMessage("You", message, true);
      socket.emit("chatMessage", message);
      input.value = "";
    }
  }

  socket.on("chatMessage", ({ sender, text }) => {
    addMessage(sender, text, false);
  });

  function addMessage(sender, text, isOwn) {
    const chatMessages = document.getElementById("chatMessages");
    const messageDiv = document.createElement("div");
    messageDiv.className = `message ${isOwn ? "own" : "other"}`;
    messageDiv.innerHTML = `<strong>${sender}:</strong> ${text}`;
    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  // üé• WebRTC Handling
  socket.on("partner-found", async (id) => {
    partnerId = id;
    showNotification("üéâ Partner found! Connecting...", "success");
    await createPeerConnection();
    const offer = await peerConnection.createOffer();
    await peerConnection.setLocalDescription(offer);
    socket.emit("signal", { to: partnerId, data: { type: "offer", offer } });
  });

  socket.on("signal", async ({ from, data }) => {
    partnerId = from;
    if (data.type === "offer") {
      await createPeerConnection();
      await peerConnection.setRemoteDescription(new RTCSessionDescription(data.offer));
      const answer = await peerConnection.createAnswer();
      await peerConnection.setLocalDescription(answer);
      socket.emit("signal", { to: from, data: { type: "answer", answer } });
    } else if (data.type === "answer") {
      await peerConnection.setRemoteDescription(new RTCSessionDescription(data.answer));
    } else if (data.type === "candidate" && peerConnection) {
      await peerConnection.addIceCandidate(new RTCIceCandidate(data.candidate));
    }
  });

  async function createPeerConnection() {
    peerConnection = new RTCPeerConnection(servers);
    localStream.getTracks().forEach(track => peerConnection.addTrack(track, localStream));

    peerConnection.ontrack = (event) => {
      const remoteVideo = document.getElementById("videoRemote");
      remoteVideo.srcObject = event.streams[0];
      remoteVideo.play();
    };

    peerConnection.onicecandidate = (event) => {
      if (event.candidate && partnerId) {
        socket.emit("signal", { to: partnerId, data: { type: "candidate", candidate: event.candidate } });
      }
    };
  }

  socket.on("partner-left", () => {
    showNotification("‚ùå Partner disconnected.", "danger");
    if (peerConnection) peerConnection.close();
    peerConnection = null;
  });

  // üéõÔ∏è CONTROLS
  function nextPartner() {
    socket.emit("find-partner");
    showNotification("üîÑ Finding new partner...", "info");
  }

  function endChat() {
    if (peerConnection) peerConnection.close();
    socket.emit("end-chat", { partnerId });
    document.getElementById("landing").style.display = "flex";
    document.getElementById("chatInterface").style.display = "none";
  }

  // üîî NOTIFICATIONS
  function showNotification(message, type = "info") {
    const box = document.createElement("div");
    box.className = "notify";
    box.style.cssText = `
      position: fixed;
      top: 20px; right: 20px;
      background: ${type === "success"
        ? "#28a745"
        : type === "danger"
        ? "#dc3545"
        : type === "warning"
        ? "#ffc107"
        : "#007bff"};
      color: white;
      padding: 10px 20px;
      border-radius: 10px;
      z-index: 9999;
      animation: fadeIn 0.3s ease-out;
    `;
    box.textContent = message;
    document.body.appendChild(box);
    setTimeout(() => box.remove(), 3000);
  }

  // Close modals on outside click
  window.onclick = function (event) {
    document.querySelectorAll(".modal").forEach(modal => {
      if (event.target === modal) modal.classList.remove("active");
    });
  };
</script>

  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'999cf65d27615a14',t:'MTc2MjM1MjExOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
